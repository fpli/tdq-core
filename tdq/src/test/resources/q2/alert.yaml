---
name: v3PoolsBusyThread
enabled: true
creator: juntzhang
type: alerting
group: tdq
expr: avg(appserverBusyThreads{_namespace_="perfmon-benchmark", pool=~"^v3.*"}) by (pool) / avg(appserverThreads{_namespace_="perfmon-benchmark", pool=~"^v3.*"}) by (pool) > 0.6
labels:
  _namespace_: perfmon-benchmark
  pool: "{{ $labels.pool}}"
annotations:
  summary: 'Busy thread alert in pool {{$labels.pool}}: {{$value}}'
notifiers:
  - notifySample1
for: 1m
# todo maybe need api callback
desc: http://docs.sherlock.io/docs/faq/alerts/

# NuMessage https://pages.github.corp.ebay.com/Near-Real-Time/rheos-documentation/docs/messaging/2.7.1-Subscribe-An-Alert/
---

TAGS_U_VALIDATE_COUNT{pageId="${pageId}"}[1h] by (pageId) < ${value}
alert
block
